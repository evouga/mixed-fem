Use d^2 for barrier only, and d for constraint...

Contouring with quadratics
https://www.cs.rice.edu/~jwarren/papers/dualcontour.pdf

3D Doctor solidworks
http://www.ablesw.com/3d-doctor/users.html