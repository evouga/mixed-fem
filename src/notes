Use d^2 for barrier only, and d for constraint...

